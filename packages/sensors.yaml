################################################################
## Packages / Sensors
################################################################
homeassistant:
  customize:
    #philips hue motion sensors
    ######Findlays Room
    sensor.findlay_room_motion:
      friendly_name: "Findlay's Room"
      icon: mdi:run
    sensor.findlay_room_lux:
      icon: mdi:theme-light-dark
    sensor.findlay_room_temperature:
      icon: mdi:thermometer
      friendly_name: Findlay's Room

    ######Living room
    sensor.living_room_motion:
      friendly_name: "Living Room"
      icon: mdi:run
    sensor.living_room_lux:
      icon: mdi:theme-light-dark
    sensor.living_room_temperature:
      icon: mdi:thermometer
      friendly_name: Living Room

    ######Dining Room
    sensor.dining_room_motion:
      friendly_name: "Dining Room"
      icon: mdi:run
    sensor.dining_room_lux:
      icon: mdi:theme-light-dark
    sensor.dining_room_temperature:
      icon: mdi:thermometer
      friendly_name: Dining Room

###### BINARY SENSORS ------------------------------------------
binary_sensor:
  - platform: huesensor
  - platform: workday
    country: CA
###### SENSORS -------------------------------------------------
sensor:
  - platform: huesensor
### tautulli and plex monitor
  - platform: tautulli
    api_key: !secret tautulli_api
    host: !secret tautulli_host
  - platform: template
    sensors:
      tautulli_lan:
        friendly_name: "tautulli_lan"
        entity_id: sensor.tautulli
        unit_of_measurement: 'Mbps'
        value_template: "{{states.sensor.tautulli.attributes.lan_bandwidth|float / 1000}}"
      tautulli_wan:
        friendly_name: "tautulli_wan"
        entity_id: sensor.tautulli
        unit_of_measurement: 'Mbps'
        value_template: "{{states.sensor.tautulli.attributes.wan_bandwidth|float / 1000}}"
      tautulli_total:
        friendly_name: "tautulli_total"
        entity_id: sensor.tautulli
        unit_of_measurement: 'Mbps'
        value_template: "{{states.sensor.tautulli.attributes.total_bandwidth|float / 1000}}"
### SCRAPE CURRENT ENERGY TIER
  # - platform: scrape
  #   resource: !secret energy_scrape_url2
  #   name: Electricity Price
  #   select: ".sml-landing-tou .sml-align-center"
  #   value_template: "{{value.split('/')[0].split('|')[1]|replace('¢','')|replace(' ','')}}"
  #   unit_of_measurement: "¢/kWh"
  #   scan_interval: 600

  - platform: scrape
    resource: !secret energy_scrape_url
    name: Electricity Price
    select: ".off-peakactive .value"
    value_template: "{{value.split('/')[0]|replace('¢','')}}"
    unit_of_measurement: "¢/kWh"
    scan_interval: 600

  #####FINDLAYS ROOM SENSOR & DIMMER
  - platform: rest
    resource: !secret finn_room_lux
    value_template: "{{(10 ** (float (value_json.state.lightlevel) / 10000) -1) | round (1)}} "
    unit_of_measurement: Lux
    name: 'Findlay Room Lux'
    scan_interval: 120

  - platform: rest
    resource: !secret finn_room_motion
    value_template: '{{ value_json.state.presence }}'
    name: 'Findlay Room Motion'
    scan_interval: 1

  - platform: rest
    resource: !secret finn_room_temp
    value_template: '{{ (value_json.state.temperature | float / 100 + 1.6) | round(1) }}'
    unit_of_measurement: °C
    name: 'Findlay Room Temperature'
    scan_interval: 120

  #####LIVING ROOM SENSOR & DIMMER
  - platform: rest
    resource: !secret livingroom_lux
    value_template: "{{(10 ** (float (value_json.state.lightlevel) / 10000) -1) | round (1)}} "
    unit_of_measurement: Lux
    name: 'Living Room Lux'
    scan_interval: 700

  - platform: rest
    resource: !secret livingroom_motion
    value_template: '{{ value_json.state.presence }}'
    name: 'Living Room Motion'
    scan_interval: 2

  - platform: rest
    resource: !secret livingroom_temp
    value_template: '{{ (value_json.state.temperature | float / 100 + 0.35) | round(1) }}'
    unit_of_measurement: °C
    name: 'Living Room Temperature'
    scan_interval: 120

  #####DINING ROOM SENSOR
  - platform: rest
    resource: !secret dining_room_lux
    value_template: "{{(10 ** (float (value_json.state.lightlevel) / 10000) -1) | round (1)}} "
    unit_of_measurement: Lux
    name: 'Dining Room Lux'
    scan_interval: 700

  - platform: rest
    resource: !secret dining_room_motion
    value_template: '{{ value_json.state.presence }}'
    name: 'Dining Room Motion'
    scan_interval: 2

  - platform: rest
    resource: !secret dining_room_temp
    value_template: '{{ (value_json.state.temperature | float / 100) | round(1) }}'
    unit_of_measurement: °C
    name: 'Dining Room Temperature'
    scan_interval: 120

###### AVERAGE TEMPERATURE
  - platform: min_max
    type: mean
    name: Average Whole Home
    entity_ids:
      - sensor.hallway_thermostat_temperature
      - sensor.findlay_room_temperature
      - sensor.living_room_temperature
      - sensor.dining_room_temperature

###### DATE TIME
  - platform: yr
  - platform: time_date
    display_options:
      - "date_time"
      - 'time'

###### DAY OF THE WEEK
  - platform: template
    sensors:
      date_weekday:
        value_template: "{{as_timestamp(now())|timestamp_custom('%A', True)}}"

###### MONTH OF THE YEAR
  - platform: template
    sensors:
      date_month:
        value_template: "{{as_timestamp(now())|timestamp_custom('%B', True)}}"
